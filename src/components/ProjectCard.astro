---
export interface Props {
  route: string;
  title: string;
}

const { route, title } = Astro.props as Props;
---

<div class="projectCard">
  <animation-link route={`/project/${route}`}>
    <div id="imageContainer">
      <img src={`/assets/${route}/poster.jpg`} alt={`${title} poster image`} />
    </div>
  </animation-link>
</div>

<script>
  import { FADE_ANIMATION_DURATION } from '@src/constants';

  class AnimationLink extends HTMLElement {
    homePage: HTMLElement | null = null;

    constructor() {
      super();

      this.homePage = document.getElementById('home');
      const card = this.querySelector('#imageContainer');

      card?.addEventListener('click', this.handleClick.bind(this));
    }

    handleClick = () => {
      this.homePage?.classList.add('fadeOut');

      setTimeout(() => {
        window.location.href = this.getAttribute('route') as string;
      }, FADE_ANIMATION_DURATION * 1000);
    };
  }

  customElements.define('animation-link', AnimationLink);
</script>

<style lang="scss">
  @import '../styles/mixins.scss';
  @import '../styles/shared.scss';

  .projectCard {
    position: relative;
    overflow: visible;

    #imageContainer {
      position: relative;
      @include aspect-ratio(16, 9);
      width: 88vw;
      min-width: 88vw;
      max-width: 88vw;
      overflow: visible;
      @include card(1);

      @include landscape {
        width: 30vw;
        min-width: 30vw;
        max-width: 30vw;
      }

      @include tablet {
        width: 42vw;
        min-width: 42vw;
        max-width: 42vw;
      }

      @include landscape {
        @include tablet {
          width: 28vw;
          min-width: 28vw;
          max-width: 28vw;
        }
      }

      @include desktop {
        width: 29vw;
        min-width: 29vw;
        max-width: 29vw;
      }

      @include landscape {
        @include desktop {
          width: unset;
          min-width: unset;
          max-width: unset;
          height: 18vh;
          min-height: 18vh;
          max-height: 18vh;
        }
      }

      @include mouse {
        cursor: pointer;

        &:hover {
          scale: 1.03;
        }
      }

      img {
        width: 100%;
        height: 100%;
        pointer-events: none;
        user-select: none;
        @include border-radius;
      }
    }
  }
</style>
